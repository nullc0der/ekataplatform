{% load staticfiles i18n bip_extras raven %}
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
        {% block title %} {% endblock title %} | Ekata
    </title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/png" href="{% static "dist/img/favicon.ico" %}"/>
    <!-- Bootstrap 3.3.6 -->
    <link rel="stylesheet" href="{% static "bootstrap/css/bootstrap.min.css" %}">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
    <!--Jquery UI-->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/ui-lightness/jquery-ui.css">
    <!--Bootstrap toggle -->
    <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
    <!-- Emojione -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/emojione/2.2.6/assets/css/emojione.min.css"/>
    <link rel="stylesheet" href="https://cdn.rawgit.com/mervick/emojionearea/master/dist/emojionearea.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="{% static "dist/css/AdminLTE.css" %}?n=7">
    <!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->
    <link rel="stylesheet" href="{% static "dist/css/skins/_all-skins.min.css" %}">
    <!-- iCheck -->
    <link rel="stylesheet" href="{% static "plugins/iCheck/flat/blue.css" %}">
    <!-- Morris chart -->
    <link rel="stylesheet" href="{% static "plugins/morris/morris.css" %}">
    <!-- jvectormap -->
    <link rel="stylesheet" href="{% static "plugins/jvectormap/jquery-jvectormap-1.2.2.css" %}">
    <!-- Date Picker -->
    <link rel="stylesheet" href="{% static "plugins/datepicker/datepicker3.css" %}">
    <!-- Daterange picker -->
    <link rel="stylesheet" href="{% static "plugins/daterangepicker/daterangepicker.css" %}">
    <!-- bootstrap wysihtml5 - text editor -->
    <link rel="stylesheet" href="{% static "plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.css" %}">
    <!--Color Picker -->
    <link rel="stylesheet" href="{% static "plugins/colorpicker/bootstrap-colorpicker.min.css" %}">
    <!-- Selectpicker -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/css/bootstrap-select.min.css">
    <!-- Bootstrap Notify -->
    <link rel="stylesheet" href="{% static "dist/css/bootstrap-notify.css" %}">
    <!--Bootstrap Table -->
    <link rel="stylesheet" href="{% static "plugins/bootstrap-table/bootstrap-table.min.css" %}">
    <!--Dropzone-->
    <link rel="stylesheet" href="https://rawgit.com/enyo/dropzone/master/dist/dropzone.css">
    <!--Full Calendar -->
    <link rel="stylesheet" href="{% static "plugins/fullcalendar/fullcalendar.min.css" %}">
    <!-- File Input -->
    <link rel="stylesheet" href="{% static "plugins/bootstrap-fileinput/css/fileinput.min.css" %}">
    <!--Tag It -->
    <link rel="stylesheet" href="{% static "plugins/tagit/jquery.tagit.css" %}">
    <!-- Date Time Picker -->
    <link rel="stylesheet" href="{% static "plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" %}">
    <!-- PicEdit -->
    <link rel="stylesheet" href="{% static "plugins/picedit/css/picedit.min.css" %}">
    <!--Sweet Alert-->
    <link rel="stylesheet" href="{% static "plugins/swal/sweetalert.css" %}">
    <!--Bootstrap Slider-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/9.5.3/css/bootstrap-slider.min.css" />
    <link rel="manifest" href="/manifest.json">

    <style>
        #msgbox {
            position: fixed;
            z-index: 1;
            bottom: -10px;
            right: 0;
        }
        .emoji {
            width: 1.5em;
            height: 1.5em;
            display: inline-block;
            margin-bottom: -0.25em;
        }
        .blink {
            animation:blink 700ms infinite alternate;
        }
        @keyframes blink {
            from { opacity:1; }
            to { opacity:0; }
        }
        .ui-loader {
            display: none;
        }
    </style>
    {% block extrastyle %} {% endblock extrastyle %}
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>

<body class="hold-transition skin-blue sidebar-mini">
    <div class="wrapper">

        <header class="main-header">
            <!-- Logo -->
            <a href="{% url 'dashboard:index' %}" class="logo">
                <!-- mini logo for sidebar mini 50x50 pixels -->
                <span class="logo-mini">EKATA</span>
                <!-- logo for regular state and mobile devices -->
                <span class="logo-lg">EKATA</span>
            </a>
            <!-- Header Navbar: style can be found in header.less -->
            <nav class="navbar navbar-static-top">
                <!-- Sidebar toggle button-->
                <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
                    <span class="sr-only">{% trans "Toggle navigation" %}</span>
                </a>

                <div class="navbar-custom-menu">
                    <ul class="nav navbar-nav">
                        <!-- Messages: style can be found in dropdown.less-->
                        <!-- TODO: Messagging and Notification system in V3 -->
                        <li class="dropdown messages-menu" id="navmessages">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="fa fa-comment-o"></i>
                                <span class="label bg-red" id="chatindicator"></span>
                            </a>
                        </li>
                         <!--Notifications: style can be found in dropdown.less-->
                        <li class="dropdown notifications-menu"  id="notification">

                        </li>
                         <!--Tasks: style can be found in dropdown.less
                        <li class="dropdown tasks-menu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="fa fa-flag-o"></i>
                                <span class="label label-danger">9</span>
                            </a>
                            <ul class="dropdown-menu">
                                <li class="header">You have 9 tasks</li>
                                <li>
                                     inner menu: contains the actual data
                                    <ul class="menu">
                                        <li>
                                             Task item
                                            <a href="#">
                                                <h3>
                                                    Design some buttons
                                                    <small class="pull-right">20%</small>
                                                </h3>
                                                <div class="progress xs">
                                                    <div class="progress-bar progress-bar-aqua" style="width: 20%" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">
                                                        <span class="sr-only">20% Complete</span>
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                         end task item
                                        <li>
                                             Task item
                                            <a href="#">
                                                <h3>
                                                    Create a nice theme
                                                    <small class="pull-right">40%</small>
                                                </h3>
                                                <div class="progress xs">
                                                    <div class="progress-bar progress-bar-green" style="width: 40%" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">
                                                        <span class="sr-only">40% Complete</span>
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                         end task item
                                        <li>
                                             Task item
                                            <a href="#">
                                                <h3>
                                                    Some task I need to do
                                                    <small class="pull-right">60%</small>
                                                </h3>
                                                <div class="progress xs">
                                                    <div class="progress-bar progress-bar-red" style="width: 60%" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">
                                                        <span class="sr-only">60% Complete</span>
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                         end task item
                                        <li>
                                             Task item
                                            <a href="#">
                                                <h3>
                                                    Make beautiful transitions
                                                    <small class="pull-right">80%</small>
                                                </h3>
                                                <div class="progress xs">
                                                    <div class="progress-bar progress-bar-yellow" style="width: 80%" role="progressbar" aria-valuenow="20" aria-valuemin="0"
                                                        aria-valuemax="100">
                                                        <span class="sr-only">80% Complete</span>
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                         end task item
                                    </ul>
                                </li>
                                <li class="footer">
                                    <a href="#">View all tasks</a>
                                </li>
                            </ul>
                        </li>
                        -->
                        <!-- User Account: style can be found in dropdown.less -->
                        <li class="dropdown user user-menu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                {% if request.user.profile.avatar %}
                                    <img src="{{ request.user.profile.avatar.thumbnail.160x160 }}" class="user-image useravatar" alt="User Image">
                                {% else %}
                                    <img src="{% static "dist/img/placeholder-user.png" %}" class="user-image useravatar" width="160" height="160">
                                {% endif %}
                                <span class="hidden-xs">
                                    {% if request.user.username %}
                                        {{ request.user.username }}
                                    {% else %}
                                       {% trans "Hello User" %}
                                    {% endif %}
                                </span>
                            </a>
                            <ul class="dropdown-menu">
                                <!-- User image -->
                                 <li class="user-header">
                                    {% if request.user.profile.avatar %}
                                        <img src="{{ request.user.profile.avatar.thumbnail.160x160 }}" class="img-circle" alt="User Image">
                                    {% else %}
                                        <img src="{% static "dist/img/placeholder-user.png" %}" class="img-circle" width="160" height="160">
                                    {% endif %}
                                    <p>
                                        {% if request.user.username %}
                                            {{ request.user.username }} - {{ request.user.profile.title }}
                                            <small>
                                                {% trans "Member Since " %} {{ request.user.date_joined|date:"M Y" }}
                                            </small>
                                        {% else %}
                                            {% trans "Hello User" %}
                                        {% endif %}
                                    </p>
                                </li>
                                <!-- Menu Body -->
                                <li class="user-body">
                                    <div class="row">
                                        <div class="col-xs-4 text-center">
                                            <a href="{% url 'profilesystem:index' %}#reference">References</a>
                                        </div>
                                        <div class="col-xs-4 text-center">
                                            <a href="{% url 'myaccount:index' %}">{% trans "Account" %}</a>
                                        </div>
                                        <div class="col-xs-4 text-center">
                                            <a href="{% url 'landing:index' %}">{% trans "Landing" %}</a>
                                        </div>
                                    </div>
                                    <!-- /.row -->
                                </li>
                                <!-- Menu Footer-->
                                <li class="user-footer">
                                    <div class="pull-left">
                                        <a href="{% url 'profilesystem:index' %}" class="btn btn-default btn-flat">{% trans "Profile" %}</a>
                                    </div>
                                    <div class="pull-right">
                                        <a href="{% url 'logout' %}" class="btn btn-default btn-flat">{% trans "Sign out" %}</a>
                                    </div>
                                </li>
                            </ul>
                        </li>
                        <!-- Control Sidebar Toggle Button -->
                        <li>
                            <a href="#" data-toggle="control-sidebar"><i class="fa fa-gears"></i></a>
                        </li>
                    </ul>
                </div>
            </nav>
        </header>
        <!-- Left side column. contains the logo and sidebar -->
        <aside class="main-sidebar">
            <!-- sidebar: style can be found in sidebar.less -->
            <section class="sidebar">
                <!-- Sidebar user panel -->
                <div class="user-panel">
                    <div class="pull-left image">
                        {% if request.user.profile.avatar %}
                            <img src="{{ request.user.profile.avatar.thumbnail.160x160 }}" class="img-circle useravatar" alt="User Image" id="userimage">
                        {% else %}
                            <img src="{% static "dist/img/placeholder-user.png" %}" class="img-circle useravatar" width="160" height="160" id="userimage">
                        {% endif %}
                    </div>
                    <div class="pull-left info">
                        <p>
                            {% if request.user.username %}
                                {{ request.user.username }}
                            {% else %}
                                {% trans "Hello User" %}
                            {% endif %}
                        </p>
                        <!-- TODO: logic for online -->
                        <a href="#"><i class="fa fa-circle text-success"></i> Online</a>
                    </div>
                </div>
                 <!-- search form -->
                <form action="#" method="get" class="sidebar-form">
                    <div class="input-group">
                        <input type="text" name="q" class="form-control" placeholder="Search...">
                        <span class="input-group-btn">
                            <button type="submit" name="search" id="search-btn" class="btn btn-flat"><i class="fa fa-search"></i></button>
                        </span>
                    </div>
                </form>
                <!-- /.search form -->
                <!-- sidebar menu: : style can be found in sidebar.less -->
                <ul class="sidebar-menu">
                    <li class="header text-center">
                        <i class="fa fa-caret-left pull-left" id="navleft"></i>
                        <span id="navheader">{% trans "MAIN NAVIGATION" %}</span>
                        <i class="fa fa-caret-right pull-right" id="navright"></i>
                    </li>
                    {% if extended_sidebar %}
                        {% if user_in_group %}
                            {% include "sidebar_group.html" %}
                            {% if user_has_admin_access %}
                                {% include "sidebar_group_admin.html" %}
                            {% endif %}
                            {% include "sidebar_main.html" %}
                        {% endif %}
                        {% if user_in_group_admin %}
                            {% if user_has_admin_access %}
                                {% include "sidebar_group_admin.html" %}
                            {% endif %}
                            {% include "sidebar_group.html" %}
                            {% include "sidebar_main.html" %}
                        {% endif %}
                    {% else %}
                        {% include "sidebar_main.html" %}
                    {% endif %}
                </ul>
            </section>
            <!-- /.sidebar -->
        </aside>

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            <section>
                {% if UPDATES %}
                    {% for update in UPDATES %}
                        <div class="alert alert-{{ update.get_message_type_display }} sysalert">
                            <a href="#" class="close ackupdate" data-id='{{ update.id }}' data-dismiss="alert" data-toggle="tooltip" data-placement="left" title="Don't show again" aria-label="close">&times;</a>
                            <p>
                                {% ifequal update.message_type '1' %}
                                    <i class="fa fa-warning"></i>
                                {% endifequal %}
                                {% ifequal update.message_type '2' %}
                                    <i class="fa fa-info-circle"></i>
                                {% endifequal %}
                                {% ifequal update.message_type '3' %}
                                    <i class="fa fa-ban"></i>
                                {% endifequal %}
                                {% trans "System notice: " %}
                                {% load tz %}
                                {% localtime on %}
                                    {{ update.timestamp|date:"d/m/Y h:i a" }}
                                {% endlocaltime %}
                                 - {{ update.message }}
                            </p>
                        </div>
                    {% endfor %}
                {% endif %}
            </section>
            <section class="content-header">
                {% block content_header %}

                {% endblock content_header %}
            </section>
            <!-- Main content -->
            <section class="content">
                <div class="notifications top-right"></div>
                {% block content %}

                {% endblock content %}
            </section>
        </div>
        <!-- /.content-wrapper -->
        <footer class="main-footer">
            <div class="pull-right hidden-xs">
                <small class="label bg-blue">Ekata</small>
                <b><small class="label {{ VERSION_COLOR }}">{{ VERSION_NAME }}</small> v{{ VERSION_NUMBER }} </b>
            </div>
            <strong>Copyright &copy; 2014-2016 <a href="/">Ekata</a>.</strong> All rights
            reserved.
            <small class="label bg-green"><a href="https://www.djangoproject.com/" target='_blank' style="color: #fff;">Powered by Django</a></small>
        </footer>

        <!-- Control Sidebar -->
        <aside class="control-sidebar control-sidebar-dark">
            <!-- Create the tabs -->
            <ul class="nav nav-tabs nav-justified control-sidebar-tabs">
                <li><a href="#control-sidebar-home-tab" data-toggle="tab"><i class="fa fa-home"></i></a></li>
                <li><a href="#control-sidebar-settings-tab" data-toggle="tab"><i class="fa fa-gears"></i></a></li>
            </ul>
            <!-- Tab panes -->
            <div class="tab-content">
                <!-- Home tab content -->
                <div class="tab-pane" id="control-sidebar-home-tab">
                    <!-- hidden untill todo is implemented
                    <h3 class="control-sidebar-heading">{% trans "Todo" %}</h3>
                    <ul class="control-sidebar-menu">
                        <li>
                            <a href="javascript:void(0)">
                                <h4 class="control-sidebar-subheading">
                                    Note by c0defreak: If todo is implemented for user could be shown here
                                    otherwise this tab will be removed
                                </h4>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0)">
                                <h4 class="control-sidebar-subheading">
                                    Update Resume
                                </h4>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0)">
                                <h4 class="control-sidebar-subheading">
                                    Laravel Integration
                                </h4>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0)">
                                <h4 class="control-sidebar-subheading">
                                    Back End Framework
                                </h4>
                            </a>
                        </li>
                    </ul>
                    /.control-sidebar-menu -->

                </div>
                <!-- /.tab-pane -->
                <!-- Stats tab content -->
                <div class="tab-pane" id="control-sidebar-stats-tab">Stats Tab Content</div>
                <!-- /.tab-pane -->
                <!-- Settings tab content -->
                <div class="tab-pane" id="control-sidebar-settings-tab">
                        <h3 class="control-sidebar-heading">{% trans "Language Settings" %}</h3>
                        <form action="{% url 'set_language' %}" method="post">
                            {% csrf_token %}
                            <input name="next" type="hidden" value="{{ request.path }}" />
                            <div class="form-group">
                                <select name="language" class="langselect">
                                    {% get_current_language as LANGUAGE_CODE %}
                                    {% get_available_languages as LANGUAGES %}
                                    {% get_language_info_list for LANGUAGES as languages %}
                                    {% for language in languages %}
                                        <option value="{{ language.code }}"{% if language.code == LANGUAGE_CODE %} selected="selected"{% endif %}>
                                            {{ language.name_local }} ({{ language.code }})
                                        </option>
                                    {% endfor %}
                                </select>
                            </div>
                            <button type="submit" class="btn btn-primary btn-sm">
                                {% comment %}
                                    Translators: This is for language select submit button
                                {% endcomment %}
                                {% trans "Set" %}
                            </button>
                        </form>
                        <!--
                        <h3 class="control-sidebar-heading">{% trans "Chat Settings" %}</h3>

                        <div class="form-group">
                            <label class="control-sidebar-subheading">
                                {% trans "Show me as online" %}
                                <input type="checkbox" class="pull-right" checked>
                            </label>
                        </div>
                         /.form-group -->
                </div>
                <!-- /.tab-pane -->
            </div>
        </aside>
        <!-- /.control-sidebar -->
        <!-- Add the sidebar's background. This div must be placed
       immediately after the control sidebar -->
        <div class="control-sidebar-bg"></div>
        <div class="se-pre-con"></div>
    </div>
    <!-- ./wrapper -->

    <audio src="{% static "dist/audio/notification.mp3" %}" id="notificaudio"></audio>
    <audio src="{% static "dist/audio/messaging.mp3" %}" id="messagingaudio"></audio>
    <!-- jQuery 2.2.3 -->
    <script src="{% static "plugins/jQuery/jquery-2.2.3.min.js" %}"></script>
    <!-- Raven -->
    <script src="https://cdn.ravenjs.com/3.7.0/raven.min.js"></script>
    <script>Raven.config('{% sentry_public_dsn %}').install()</script>
    <!-- jQuery UI 1.11.4 -->
    <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
    <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
    <script>
        $.widget.bridge('uibutton', $.ui.button);
    </script>
    <!-- Bootstrap 3.3.6 -->
    <script src="{% static "bootstrap/js/bootstrap.min.js" %}"></script>
    <!-- Morris.js charts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
    <!-- Bootstrap toggle -->
    <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
    <script src="{% static "plugins/morris/morris.min.js" %}"></script>
    <!-- Sparkline -->
    <script src="{% static "plugins/sparkline/jquery.sparkline.min.js" %}"></script>
    <!-- jvectormap -->
    <script src="{% static "plugins/jvectormap/jquery-jvectormap-1.2.2.min.js" %}"></script>
    <script src="{% static "plugins/jvectormap/jquery-jvectormap-world-mill-en.js" %}"></script>
    <!-- jQuery Knob Chart -->
    <script src="{% static "plugins/knob/jquery.knob.js" %}"></script>
    <!-- daterangepicker -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.11.2/moment.min.js"></script>
    <script src="{% static "dist/js/moment-timezone-with-data.min.js" %}"></script>
    <script src="{% static "plugins/daterangepicker/daterangepicker.js" %}"></script>
    <!-- datepicker -->
    <script src="{% static "plugins/datepicker/bootstrap-datepicker.js" %}"></script>
    <!-- Bootstrap WYSIHTML5 -->
    <script src="{% static "plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js" %}"></script>
    <!-- Slimscroll -->
    <script src="{% static "plugins/slimScroll/jquery.slimscroll.min.js" %}"></script>
    <!-- FastClick -->
    <script src="{% static "plugins/fastclick/fastclick.js" %}"></script>
    <!-- chartjs -->
    <script src="{% static "plugins/chartjs/Chart.min.js" %}"></script>
    <!-- Selectpicker -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/js/bootstrap-select.min.js"></script>
    <!-- Bootstrap Notify -->
    <script src="{% static "dist/js/bootstrap-notify.js" %}"></script>
    <!-- Bootstrap Table -->
    <script src="{% static "plugins/bootstrap-table/bootstrap-table.min.js" %}"></script>
    <script src="{% static "plugins/bootstrap-table/bootstrap-table-export.min.js" %}"></script>
    <!-- Color Picker -->
    <script src="{% static "plugins/colorpicker/bootstrap-colorpicker.min.js" %}"></script>
    <script src="https://rawgit.com/hhurz/tableExport.jquery.plugin/master/tableExport.js"></script>
    <!-- Emojione -->
    <script src="//cdn.jsdelivr.net/emojione/2.2.6/lib/js/emojione.min.js"></script>
    <script src="https://cdn.rawgit.com/mervick/emojionearea/master/dist/emojionearea.min.js"></script>
    <!-- DropZone -->
    <script src="{% static "dist/js/dropzone.js" %}"></script>
    <!-- Jquery Swipe -->
    <script src="{% static "plugins/jqueryswipe/jquery.event.move.js" %}"></script>
    <script src="{% static "plugins/jqueryswipe/jquery.event.swipe.js" %}"></script>
    <!--Full Calendar -->
    <script src="{% static "plugins/fullcalendar/fullcalendar.min.js" %}"></script>
    <!-- File Input -->
    <script src="{% static "plugins/bootstrap-fileinput/js/fileinput.min.js" %}"></script>
    <!-- Tag It -->
    <script src="{% static "plugins/tagit/tag-it.js" %}"></script>
    <!-- Date time Picker -->
    <script src="{% static "plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js" %}"></script>
    <!-- PicEdit -->
    <script src="{% static "plugins/picedit/js/picedit.min.js" %}"></script>
    <!-- AdminLTE App -->
    <script src="{% static "dist/js/app.js" %}"></script>
    <!-- AdminLTE for demo purposes -->
    <script src="{% static "dist/js/demo.js" %}"></script>
    <!--Sweet alert-->
    <script src="{% static "plugins/swal/sweetalert.min.js" %}"></script>
    <!--Bootstrap Slider-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/9.5.3/bootstrap-slider.min.js"></script>
    <!-- File Saver -->
    <script src="{% static "plugins/filesaver/FileSaver.min.js" %}"></script>
    <script type="text/javascript">
        var convertEmojis = function (single) {
            emojione.imageType = 'svg';
            emojione.sprites = true;
            emojione.imagePathSVGSprites = '{% static "plugins/emojione/emojione.sprites.svg" %}';
            var single = typeof single !== 'undefined' ?  single : false;
            if (single) {
                var chattext = $(".direct-chat-text>p").last();
                var input = $(chattext).text();
                var output = emojione.toImage(input);
                $(chattext).html(output);
            }
            else {
                var chattext = $(".direct-chat-text>p");
                chattext.each(function(){
                    var input = $(this).text();
                    var output = emojione.toImage(input);
                    $(this).html(output);
                });
            }
        };
        /*function expandCollapseNavbar(content_class, pos_class) {
           if ($(content_class).is(":visible")) {
                $(content_class).slideUp();
                $(pos_class).removeClass('fa-minus');
                $(pos_class).addClass('fa-plus');
           }
           else {
                $(content_class).slideDown();
                $(pos_class).removeClass('fa-plus');
                $(pos_class).addClass('fa-minus');
           }
        }*/
        function getCookie(name) {
            var cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                var cookies = document.cookie.split(';');
                for (var i = 0; i < cookies.length; i++) {
                    var cookie = jQuery.trim(cookies[i]);
                    // Does this cookie string begin with the name we want?
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
        var csrftoken = getCookie('csrftoken');
        function csrfSafeMethod(method) {
            // these HTTP methods do not require CSRF protection
            return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
        }
        $.ajaxSetup({
            beforeSend: function(xhr, settings) {
                if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                    xhr.setRequestHeader("X-CSRFToken", csrftoken);
                }
            }
        });
        jQuery.ajaxSettings.traditional = true;
        function setMessageRead(single, id) {
            var single = typeof single !== 'undefined' ?  single : false;
            var id = typeof id !== 'undefined' ? id : null;

            var message_ids = [];
            if (single) {
                message_ids.push(id)
            }
            else {
                $(".messages").each(function(){
                    if ($(this).data('read') === 'no') {
                        var id = $(this).data('id');
                        message_ids.push(id);
                    }
                });
            }
            if (message_ids.length) {
                $.ajax({
                    url: '{% url 'messaging:setstatus' %}',
                    type: 'POST',
                    data: {'message_ids': message_ids},
                });
            }
        }
        {% if extended_sidebar %}
        $("#navleft").show();
        $("#navright").show();
        var navbar = 0;
        {% if user_in_group %}
            {% if user_has_admin_access %}
            var maxnavbar = 2;
            var navbarcontent_classes = ['.groupnavcontent', '.groupadminnavcontent', '.mainnavcontent'];
            var navbar_names = ["GROUP NAVIGATION", "GROUP ADMIN NAVIGATION", "{% trans "MAIN NAVIGATION" %}",]
            {% else %}
            var maxnavbar = 1;
            var navbarcontent_classes = ['.groupnavcontent', '.mainnavcontent'];
            var navbar_names = ["GROUP NAVIGATION", "{% trans "MAIN NAVIGATION" %}",]
            {% endif %}
        {% endif %}
        {% if user_in_group_admin %}
            {% if user_has_admin_access %}
            var maxnavbar = 2;
            var navbarcontent_classes = ['.groupadminnavcontent', '.groupnavcontent', '.mainnavcontent'];
            var navbar_names = ["GROUP ADMIN NAVIGATION", "GROUP NAVIGATION", "{% trans "MAIN NAVIGATION" %}",]
            {% else %}
            var maxnavbar = 1;
            var navbarcontent_classes = ['.groupnavcontent', '.mainnavcontent'];
            var navbar_names = ["GROUP NAVIGATION", "{% trans "MAIN NAVIGATION" %}",]
            {% endif %}
        {% endif %}
        $.each(navbarcontent_classes ,function(index) {
            if (index !== 0) {
                $(navbarcontent_classes[index]).hide();
            }
        });
        $("#navheader").text(navbar_names[0]);
        $("#navright").click(function(event) {
            navRight();
        });
        $("#navleft").click(function(event) {
            navLeft();
        });
        $(".header").on('swipeleft', function(event) {
            navLeft();
        });
        $(".header").on('swiperight', function(event) {
            navRight();
        });
        function navRight() {
            var divclass = navbarcontent_classes[navbar];
            $(divclass).hide();
            if (navbar === maxnavbar) {
                var right_divclass = navbarcontent_classes[0];
            }
            else {
                var right_divclass = navbarcontent_classes[navbar + 1];
            }
            if (navbar === maxnavbar) {
                $("#navheader").text(navbar_names[0]);
            }
            else {
                $("#navheader").text(navbar_names[navbar + 1]);
            }
            $(right_divclass).show('slow');
            if (navbar === maxnavbar) {
                navbar = 0;
            }
            else {
                navbar = navbar + 1;
            }
        }
        function navLeft() {
            var divclass = navbarcontent_classes[navbar];
            $(divclass).hide();
            if (navbar === 0) {
                var left_divclass = navbarcontent_classes[maxnavbar];
            }
            else {
                var left_divclass = navbarcontent_classes[navbar - 1];
            }
            if (navbar === 0) {
                $("#navheader").text(navbar_names[maxnavbar]);
            }
            else {
                $("#navheader").text(navbar_names[navbar - 1]);
            }
            $(left_divclass).show('slow');
            if (navbar === 0) {
                navbar = maxnavbar;
            }
            else {
                navbar = navbar - 1;
            }
        }
        {% else %}
        $("#navleft").hide();
        $("#navright").hide();
        {% endif %}
        function getChats(){
            $.ajax({
                url: '{% url 'messaging:index' %}?navbar',
                success: function(data){
                    if (data.has_unread) {
                        $("#chatindicator").text(data.has_unread);
                        $("#chatindicator").show();
                        $("#sidebarchat").text(data.has_unread);
                        $("#sidebarchat").show();
                    }
                    else {
                        $("#chatindicator").hide();
                        $("#sidebarchat").hide();
                    }
                    $("#navmessages").append(data.html);
                    $(".menu").slimscroll({
                        height: '200px',
                        size: '3px',
                        alwaysVisible: false
                    });
                }
            });
        };
        getChats();
        {% url 'messaging:index' as mess %}
        {% ifequal request.path mess %}
        {% else %}
        function openChat(chat_id, chatroom) {
            $.ajax({
                url: '/messaging/chat/' + chat_id + '/?floating',
                success: function(data) {
                    $("#msgbox").remove();
                    $(".content").append(data);
                    $(".direct-chat-messages").slimscroll({
                        height: '350px',
                        size: '3px',
                        alwaysVisible: false,
                        start: 'bottom'
                    });
                    $("li[data-name='" + chatroom + "']").removeClass("blink");
                    convertEmojis();
                    setMessageRead();
                    setTimeout(function() { getChats(); }, 3000);
                }
            });
        }
        {% endifequal %}
        $('.langselect').selectpicker();
        $(window).load(function() {
            // Animate loader off screen
            $(".se-pre-con").fadeOut("slow");
        });
        $("#notindicator").hide();
        $("#chatindicator").hide();
        $("#sidebarchat").hide();
        $.ajax({
            url: '{% url 'profilesystem:getui' %}',
            success: function(data){
                if (data) {
                    localStorage.removeItem('uistate');
                    store('uistate', data);
                }
                else {
                    var uistate = {
                        timerwidget: {"removed": false, 'collapsed': false},
                        connectionwidget: {"removed": false, 'collapsed': false},
                        profilewidget: {"removed": false, 'collapsed': false},
                        personalwidget: {'collapsed': false},
                        locationwidget: {'collapsed': false},
                        contactwidget: {'collapsed': false},
                        activitieswidget: {'collapsed': false},
                        documentwidget: {'collapsed': false},
                        sdocumentwidget: {'collapsed': false},
                        visibiltywidget: {'collapsed': false},
                        socialwidget: {'collapsed': false},
                        emailwidget: {'collapsed': false},
                        referencewidget: {'collapsed': false},
                        appswidget: {'collapsed': false},
                        siteswidget: {'collapsed': false},
                        mygroupswidget: {'collapsed': false},
                        subscribedgroupswidget: {'collapsed': false},
                        joinedgroupswidget: {'collapsed': false},
                        adswidget: {'collapsed': false},
                    }
                    localStorage.removeItem('uistate');
                    store('uistate', JSON.stringify(uistate));
                }
            }
        });
        $.ajax({
            url: '{% url 'notification:index' %}',
            success: function(data){
                $("#notification").append(data.html_s);
                if (data.unread) {
                    $("#notindicator").text(data.unread);
                    $("#notindicator").show();
                }
                $(".menu").slimscroll({
                    height: '200px',
                    size: '3px',
                    alwaysVisible: false
                });
            }
        });
        $(document).on('click', '.notification', function(){
            var notification = $(this);
            $.ajax({
                url: '{% url 'notification:setnotificationread' %}',
                type: 'POST',
                data: {'notification_id': notification.attr('data-id')},
                async: false,
                success: function(){
                    notification.remove();
                    var count = $("#notindicator").text();
                    if (count == 1) {
                        $("#notindicator").hide();
                    }
                    else{
                        $("#notindicator").text(count - 1);
                    }
                }
            });
        });
        $(document).on('click', '.notification-control', function(){
            $.ajax({
                url: '{% url 'notification:setallread' %}',
                type: 'POST',
                success: function (data) {
                    $("#notification").html(data.html_s);
                    if (data.unread) {
                        $("#notindicator").text(data.unread);
                        $("#notindicator").show();
                    }
                    else {
                        $("#notindicator").hide();
                    }
                    $(".menu").slimscroll({
                        height: '200px',
                        size: '3px',
                        alwaysVisible: false
                    });
                }
            });
        });
    </script>
    <script type="text/javascript" src="{% static "dist/js/widgetstate.js" %}"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/ws4redis.js"></script>
    <script type="text/javascript">
        var protocol = location.protocol;
        var proto = protocol == 'https:' ? 'wss:' : 'ws:';
        var ws4redis = WS4Redis({
            uri: proto + '//' + location.host + '/ws/realtime_notification?subscribe-user',
            connecting: on_connecting,
            receive_message: receiveMessage,
            heartbeat_msg: {{ WS4REDIS_HEARTBEAT }}
        });
        function on_connecting (){
            console.log("connecting....");
        }
        function receiveMessage(msg) {
            $('.top-right').notify({
                message: { text: msg},
                type: 'info',
            }).show();
            var audio = document.getElementById('notificaudio');
            audio.play();
            $.ajax({
                url: '{% url 'notification:index' %}',
                success: function(data){
                    $("#notification").html(data.html_s);
                    $(".menu").slimscroll({
                        height: '200px',
                        size: '3px',
                        alwaysVisible: false
                    });
                    $("#notindicator").text(data.unread);
                    $("#notindicator").show();
                }
            });
        }
        {% url 'messaging:index' as mess %}
        {% ifequal request.path mess %}
        {% else %}
            var messaging_realtime = WS4Redis({
                uri: proto + '//' + location.host + '/ws/messaging_realtime?subscribe-user',
                connecting: console.log("connecting...."),
                receive_message: receiveRMessage,
                heartbeat_msg: {{ WS4REDIS_HEARTBEAT }}
            });
            function receiveRMessage(msg) {
                var data = JSON.parse(msg);
                var chatroom = data.chatroom;
                var activediv = $("#msgbox").data('name');
                if (chatroom === activediv){
                    $('.direct-chat-messages').append(data.message);
                    $(".direct-chat-messages").slimscroll({
                        scrollBy: '100px',
                    });
                    convertEmojis(true);
                    setMessageRead(true, data.message_id);
                }
                else {
                    $.ajax({
                        url: '{% url 'messaging:index' %}?navbar',
                        success: function(data){
                            $("#navmessages").append(data.html);
                            $(".menu").slimscroll({
                                height: '200px',
                                size: '3px',
                                alwaysVisible: false
                            });
                            $("li[data-name='" + chatroom + "']").addClass("blink");
                            var messageaudio = document.getElementById('messagingaudio');
                            messageaudio.play();
                            if (data.has_unread) {
                                $("#chatindicator").text(data.has_unread);
                                $("#chatindicator").show();
                                $("#sidebarchat").text(data.has_unread);
                                $("#sidebarchat").show();
                            }
                        }
                    });
                }
            }
        {% endifequal %}
        $(".ackupdate").click(function(){
            var sysupdate_id = $(this).attr('data-id');
            $.ajax({
                url: '{% url 'profilesystem:acknowledgesysupdate' %}',
                type: 'POST',
                data: {'id': sysupdate_id},
                success: function(data) {
                    $('.top-right').notify({
                        message: { text: 'This message will not show again' },
                        type: 'success'
                    }).show();
                }
            });
        });
        (function setOnline(){
            $.ajax({
                url: '{% url 'profilesystem:setonline' %}',
                type: 'POST',
                complete: function() {
                    setTimeout(setOnline, 15000);
                }
            });
        })();
    </script>
    {% block extrascripts %}
    {% endblock extrascripts %}
    <script type="text/javascript">
        (function() {
            var s = document.createElement("script");
            s.type = "text/javascript";
            s.async = true;
            s.src = '//api.usersnap.com/load/'+
                '41f43a68-14ce-4085-b6ef-58aa08f57ee0.js';
            var x = document.getElementsByTagName('script')[0];
            x.parentNode.insertBefore(s, x);
        })();
    </script>
    <script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async='async'></script>
    <script>
    var OneSignal = window.OneSignal || [];
    OneSignal.push(["init", {
      appId: "69dc9060-3af3-4209-82c7-7de5219830b3",
      //appId: "10a7899d-da98-40d4-bfec-6c7983cf1148",
      autoRegister: false, /* Set to true to automatically prompt visitors */
      //subdomainName: 'https://bipproject-c0defreak-c9users.onesignal.com',
      //subdomainName: 'https://biptest.onesignal.com',
      notifyButton: {
          enable: true, /* Set to false to hide */
          position: 'bottom-left'
      }
    }]);
    OneSignal.push(function() {
        OneSignal.getUserId(function(userId) {
            if (userId) {
                var params = {
                    'onesignalid': userId
                }
                $.ajax({
                    url: '{% url 'profilesystem:onesignal' %}',
                    type: 'POST',
                    data: params,
                    success: function(){
                        console.log("OneSignal submit done");
                    },
                    error: function(){
                        console.log("OneSignal submit error")
                    }
                });
            }
        });
    });
    </script>
</body>
</html>
